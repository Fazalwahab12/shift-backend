{
  "info": {
    "name": "Shift Notification API Tests",
    "description": "Complete test collection for the Shift notification system",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3001"
    },
    {
      "key": "test_user_id",
      "value": "user_123_test"
    },
    {
      "key": "test_company_id",
      "value": "company_123_test"
    },
    {
      "key": "test_seeker_id",
      "value": "seeker_123_test"
    }
  ],
  "item": [
    {
      "name": "Health Checks",
      "item": [
        {
          "name": "Server Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": ["{{base_url}}"],
              "path": ["health"]
            }
          },
          "response": []
        },
        {
          "name": "Notification Service Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/notifications/health",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "health"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Direct Notification Tests",
      "item": [
        {
          "name": "Send Custom Email + In-App Notification",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"custom_notification\",\n  \"initiatedBy\": \"system\",\n  \"action\": \"Test Notification\",\n  \"description\": \"Testing notification system\",\n  \"receivers\": [\n    {\n      \"id\": \"{{test_user_id}}\",\n      \"type\": \"user\",\n      \"email\": \"wahabdir567@gmail.com\"\n    }\n  ],\n  \"channels\": [\"email\", \"in-app\"],\n  \"content\": {\n    \"message\": \"This is a test notification to verify the system is working correctly.\",\n    \"subject\": \"Test Notification - Shift System\",\n    \"actionUrl\": \"https://shift-oman.com/dashboard\"\n  },\n  \"metadata\": {\n    \"testRun\": true,\n    \"timestamp\": \"2024-01-15T10:30:00Z\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/notifications/send",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "send"]
            }
          },
          "response": []
        },
        {
          "name": "Send In-App Only Notification",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"type\": \"in_app_only\",\n  \"initiatedBy\": \"system\",\n  \"action\": \"In-App Test\",\n  \"description\": \"Testing in-app notification only\",\n  \"receivers\": [\n    {\n      \"id\": \"{{test_user_id}}\",\n      \"type\": \"user\"\n    }\n  ],\n  \"channels\": [\"in-app\"],\n  \"content\": {\n    \"message\": \"This is an in-app only notification (no email).\"\n  },\n  \"metadata\": {\n    \"testType\": \"in-app-only\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/notifications/send",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "send"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Business Logic Notifications",
      "item": [
        {
          "name": "Company Account Created",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"companyData\": {\n    \"id\": \"{{test_company_id}}\",\n    \"email\": \"wahabdir567@gmail.com\",\n    \"name\": \"Test Company Ltd\",\n    \"companyName\": \"Test Company Ltd\"\n  },\n  \"adminEmails\": [\"wahabdir567@gmail.com\"]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/notifications/company-created",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "company-created"]
            }
          },
          "response": []
        },
        {
          "name": "Job Seeker Profile Created",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"seekerData\": {\n    \"id\": \"{{test_seeker_id}}\",\n    \"email\": \"wahabdir567@gmail.com\",\n    \"firstName\": \"John\",\n    \"lastName\": \"Doe\"\n  },\n  \"adminEmails\": [\"wahabdir567@gmail.com\"]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/notifications/seeker-created",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "seeker-created"]
            }
          },
          "response": []
        },
        {
          "name": "Application Submitted",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"jobSeekerName\": \"John Doe\",\n  \"jobSeekerEmail\": \"wahabdir567@gmail.com\",\n  \"jobSeekerId\": \"{{test_seeker_id}}\",\n  \"companyName\": \"Test Company Ltd\",\n  \"companyEmail\": \"wahabdir567@gmail.com\",\n  \"companyId\": \"{{test_company_id}}\",\n  \"jobTitle\": \"Software Developer\",\n  \"jobId\": \"job_123_test\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/notifications/application-submitted",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "application-submitted"]
            }
          },
          "response": []
        },
        {
          "name": "Interview Request",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"jobSeekerName\": \"John Doe\",\n  \"jobSeekerEmail\": \"wahabdir567@gmail.com\",\n  \"jobSeekerId\": \"{{test_seeker_id}}\",\n  \"companyName\": \"Test Company Ltd\",\n  \"companyId\": \"{{test_company_id}}\",\n  \"jobTitle\": \"Software Developer\",\n  \"jobId\": \"job_123_test\",\n  \"interviewDate\": \"2024-01-20 10:00 AM\",\n  \"location\": \"Test Company Office, Muscat\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/notifications/interview-request",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "interview-request"]
            }
          },
          "response": []
        },
        {
          "name": "Payment Successful",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"companyId\": \"{{test_company_id}}\",\n  \"companyEmail\": \"wahabdir567@gmail.com\",\n  \"companyName\": \"Test Company Ltd\",\n  \"amount\": \"25.000\",\n  \"currency\": \"OMR\",\n  \"planName\": \"Premium Plan\",\n  \"adminEmails\": [\"wahabdir567@gmail.com\"]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/notifications/payment-successful",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "payment-successful"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Retrieve Notifications",
      "item": [
        {
          "name": "Get User Notifications",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/notifications/user/{{test_user_id}}?limit=10&offset=0",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "user", "{{test_user_id}}"],
              "query": [
                {
                  "key": "limit",
                  "value": "10"
                },
                {
                  "key": "offset",
                  "value": "0"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get Unread Notifications Only",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/notifications/user/{{test_user_id}}?unreadOnly=true&limit=20",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "user", "{{test_user_id}}"],
              "query": [
                {
                  "key": "unreadOnly",
                  "value": "true"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get Unread Count",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/api/notifications/unread-count/{{test_user_id}}",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "unread-count", "{{test_user_id}}"]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Notification Actions",
      "item": [
        {
          "name": "Mark Notification as Read",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{test_user_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/notifications/NOTIFICATION_ID_HERE/read",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "NOTIFICATION_ID_HERE", "read"]
            },
            "description": "Replace NOTIFICATION_ID_HERE with actual notification ID from previous responses"
          },
          "response": []
        },
        {
          "name": "Bulk Mark as Read",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"notificationIds\": [\"notif_1\", \"notif_2\", \"notif_3\"],\n  \"userId\": \"{{test_user_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/notifications/bulk-read",
              "host": ["{{base_url}}"],
              "path": ["api", "notifications", "bulk-read"]
            },
            "description": "Replace the notificationIds array with actual IDs from previous responses"
          },
          "response": []
        }
      ]
    }
  ]
}